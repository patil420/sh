#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define SIZE 10
#define PRIME 7

// Structure to store client details
struct client {
    int id;
    long phone;
    char name[30];
};

struct client table[SIZE];
int status[SIZE]; // 0 = empty, 1 = occupied

// Hash functions
int hash1(int key) {
    return key % SIZE;
}

int hash2(int key) {
    return PRIME - (key % PRIME);
}

// Insert using Linear Probing
void insertLinear(int id, long phone, char name[]) {
    int index = hash1(id);
    int i = 0;

    while (status[(index + i) % SIZE] == 1 && i < SIZE)
        i++;

    if (i == SIZE) {
        printf("Hash table is full!\n");
        return;
    }

    int pos = (index + i) % SIZE;
    table[pos].id = id;
    table[pos].phone = phone;
    strcpy(table[pos].name, name);
    status[pos] = 1;

    printf("Inserted %s using Linear Probing at position %d\n", name, pos);
}

// Insert using Quadratic Probing
void insertQuadratic(int id, long phone, char name[]) {
    int index = hash1(id);
    int i = 0;

    while (status[(index + i * i) % SIZE] == 1 && i < SIZE)
        i++;

    if (i == SIZE) {
        printf("Hash table is full!\n");
        return;
    }

    int pos = (index + i * i) % SIZE;
    table[pos].id = id;
    table[pos].phone = phone;
    strcpy(table[pos].name, name);
    status[pos] = 1;

    printf("Inserted %s using Quadratic Probing at position %d\n", name, pos);
}

// Insert using Double Hashing
void insertDouble(int id, long phone, char name[]) {
  
    int index = hash1(id);
    int step = hash2(id);
    int i = 0;

    while (status[(index + i * step) % SIZE] == 1 && i < SIZE)
        i++;

    if (i == SIZE) {
        printf("Hash table is full!\n");
        return;
    }

    int pos = (index + i * step) % SIZE;
    table[pos].id = id;
    table[pos].phone = phone;
    strcpy(table[pos].name, name);
    status[pos] = 1;

    printf("Inserted %s using Double Hashing at position %d\n", name, pos);
}

// Display the hash table
void display() {
    printf("\nHash Table:\n");
    for (int i = 0; i < SIZE; i++) {
        if (status[i] == 1)
            printf("[%d] ID:%d Name:%s Phone:%ld\n", i, table[i].id, table[i].name, table[i].phone);
        else
            printf("[%d] --- Empty ---\n", i);
    }
}

int main() {
    int choice, id, method;
    long phone;
    char name[30];

    printf("Telephone Book Hash Table\n");
    printf("Choose Collision Handling Method:\n");
    printf("1. Linear Probing\n2. Quadratic Probing\n3. Double Hashing\n");
    printf("Enter your choice: ");
    scanf("%d", &method);

    while (1) {
        printf("\nMenu:\n1. Insert Client\n2. Display Table\n3. Exit\nEnter your choice: ");
        scanf("%d", &choice);

        switch (choice) {
            case 1:
                printf("Enter ID: ");
                scanf("%d", &id);
                printf("Enter Name: ");
                scanf("%s", name);
                printf("Enter Phone Number: ");
                scanf("%ld", &phone);

                if (method == 1)
                    insertLinear(id, phone, name);
                else if (method == 2)
                    insertQuadratic(id, phone, name);
                else if (method == 3)
                    insertDouble(id, phone, name);
                else
                    printf("Invalid method!\n");
                break;

            case 2:
                display();
                break;

            case 3:
                printf("Exiting program...\n");
                return 0;

            default:
                printf("Invalid choice!\n");
        }
    }
}


